"use strict";(self.webpackChunkbillit=self.webpackChunkbillit||[]).push([[592],{7672:(M,u,o)=>{o.d(u,{e:()=>D});var p=o(655),_=o(6344),v=o(1135),m=o(4464),r=o(9067),a=o(9670),c=o(5899),d=o(5e3),g=o(520),L=o(4416),f=o(7261),E=o(7048);let D=(()=>{class l{constructor(t,i,e,s){this.http=t,this.helperService=i,this._snackBar=e,this.dialogService=s,this.itemList$=new v.X(null),this.itemUrl=_.a.itemUrl,this.isDataLoaded=!1}addItem(t){return(0,p.mG)(this,void 0,void 0,function*(){const i=this.dialogService.openDialog(c.pW,a.ib.progressBar);i.componentInstance.mode="indeterminate",i.componentInstance.color="accent";const e=yield(0,m.n)(this.http.post(this.itemUrl,t,{params:{shopId:r.cQ.storageHelper.shopId}}));i.close();const s=this.getItemListValue();return s.length?(s.splice(this.helperService._alphebaticallocationOf(e,s),0,e),this.itemList$.next(s)):this.itemList$.next([e]),this._snackBar.open("Item added successfully!",null,a.R$.success),e})}getAllItems(){return this.isDataLoaded||this.loadItems(),this.itemList$.asObservable()}getItem(t){return(0,p.mG)(this,void 0,void 0,function*(){const i=this.getItemListValue();for(const n of i)if(n._id===t)return n;const e=this.dialogService.openDialog(c.pW,a.ib.progressBar);e.componentInstance.mode="indeterminate",e.componentInstance.color="accent";const s=yield(0,m.n)(this.http.get(`${this.itemUrl}/${t}`,{params:{shopId:r.cQ.storageHelper.shopId}}));return e.close(),s})}updateItem(t,i){return(0,p.mG)(this,void 0,void 0,function*(){const e=this.dialogService.openDialog(c.pW,a.ib.progressBar);e.componentInstance.mode="indeterminate",e.componentInstance.color="accent";const s=yield(0,m.n)(this.http.patch(`${this.itemUrl}/${t}`,i,{params:{shopId:r.cQ.storageHelper.shopId}}));e.close();const n=this.getItemListValue(),h=n.findIndex(I=>I._id===t);-1!==h&&(n.splice(h,1)[0].name.toLocaleLowerCase()===s.name.toLocaleLowerCase()?n.splice(h,0,s):n.splice(this.helperService._alphebaticallocationOf(s,n),0,s),this.itemList$.next(n),this._snackBar.open("Item updated successfully!",null,a.R$.success))})}removeItem(t){return(0,p.mG)(this,void 0,void 0,function*(){const i=_.a.removeItemUrl,e=this.dialogService.openDialog(c.pW,a.ib.progressBar);e.componentInstance.mode="indeterminate",e.componentInstance.color="accent",yield(0,m.n)(this.http.patch(`${i}/${t}`,null,{params:{shopId:r.cQ.storageHelper.shopId}})),e.close();const s=this.itemList$.getValue(),n=s.findIndex(h=>h._id===t);-1!==n&&(s.splice(n,1),this.itemList$.next(s)),this._snackBar.open("Item removed successfully!",null,a.R$.success)})}deleteItem(t){return(0,p.mG)(this,void 0,void 0,function*(){const i=this.dialogService.openDialog(c.pW,a.ib.progressBar);i.componentInstance.mode="indeterminate",i.componentInstance.color="accent",yield(0,m.n)(this.http.delete(`${this.itemUrl}/${t}`,{params:{shopId:r.cQ.storageHelper.shopId}})),i.close();const e=this.itemList$.getValue(),s=e.findIndex(n=>n._id===t);-1!==s&&(e.splice(s,1),this.itemList$.next(e)),this._snackBar.open("Item deleted successfully!",null,a.R$.success)})}loadItems(){const t=this.dialogService.openDialog(c.pW,a.ib.progressBar);t.componentInstance.mode="indeterminate",t.componentInstance.color="accent",this.http.get(_.a.allItemsUrl,{params:{shopId:r.cQ.storageHelper.shopId}}).subscribe(i=>{this.itemList$.next(i),this.isDataLoaded=!0,t.close()})}getItemListValue(){return this.itemList$.getValue()}}return l.\u0275fac=function(t){return new(t||l)(d.LFG(g.eN),d.LFG(L.W),d.LFG(f.ux),d.LFG(E.x))},l.\u0275prov=d.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()}}]);